"use strict";function initMaps(t,e,a,n,r,s,i,l,o,p,c,d,g,f){function u(t,a,n,r,s){var i=".map-"+journeyConfigs.mapEl.dumpingWharves.slug,o="#map-"+journeyConfigs.mapEl.dumpingWharves.slug+"-svg",p=.99*$(i).width(),c=e,d=d3.geo.mercator().scale(1).translate([0,0]),g=d3.geo.path().projection(d),f=g.bounds(t),u=.65,y=u/Math.max((f[1][0]-f[0][0])/p,(f[1][1]-f[0][1])/c),h=[(p-y*(f[1][0]+f[0][0]))/2,(c-y*(f[1][1]+f[0][1]))/2];d.scale(y).translate(h),d3.select(o)&&d3.select(o).remove();var m=d3.select(i).append("svg").attr("width",p).attr("height",c).attr("id",o.substring(1,o.length)).on("click",function(t){journeyConfigs.mapEl.dumpingWharves.startAnimation()});$(o).css({position:"absolute",top:-l});var j=(m.append("circle").attr("cx",p/2).attr("cy",c/2).attr("r",p/2).attr("fill",journeyConfigs.mapConfigs.colors.background).attr("stroke-width",0),m.append("clipPath").attr("id","mapClip").append("circle").attr("cx",p/2).attr("cy",c/2).attr("r",p/2),m.append("g").attr("class","mapGroup").attr("clip-path","url(#mapClip)")),C=j.append("g").attr("class","usStates"),w=j.append("g").attr("class","nycd"),k=j.append("g").attr("class","dumpingLines"),_=j.append("g").attr("class","dumpingWharves"),v=j.append("g").attr("class","dumpingLocation");w.selectAll(".nycd").data(s.features).enter().append("path").attr({d:g}).style("stroke",journeyConfigs.mapConfigs.colors.land).style("stroke-width",0).style("fill",journeyConfigs.mapConfigs.colors.land),C.selectAll(".usStates").data(r.features).enter().append("path").attr({d:g}).style("stroke","#fff").style("stroke-width",0).style("fill",journeyConfigs.mapConfigs.colors.land),k.selectAll(".dumpingLines").data(t.features).enter().append("path").attr({d:g,"stroke-dasharray":"0 5000"}).style("stroke",journeyConfigs.mapConfigs.colors.wasteLines).attr("stroke-width",1.5).style("fill","none").attr("stroke-dasharray",function(t){return this.getTotalLength()+" "+this.getTotalLength()}).attr("stroke-dashoffset",function(t){return this.getTotalLength()}).attr("class","dumpingLines"),_.selectAll(".dumpingWharves").data(a.features).enter().append("circle").attr("cx",function(t){return d([t.geometry.coordinates[0],t.geometry.coordinates[1]])[0]}).attr("cy",function(t){return d([t.geometry.coordinates[0],t.geometry.coordinates[1]])[1]}).attr("r",3).style("stroke","#fff").style("stroke-width",1).style("fill",journeyConfigs.mapConfigs.colors.wasteCircles).attr("class","dumpingWharves"),v.selectAll(".dumpingLocation").data(n.features).enter().append("circle").attr("cx",function(t){return d([t.geometry.coordinates[0],t.geometry.coordinates[1]])[0]}).attr("cy",function(t){return d([t.geometry.coordinates[0],t.geometry.coordinates[1]])[1]}).attr("r",0).attr("opacity",.7).style("stroke","#fff").style("stroke-width",1).style("fill",journeyConfigs.mapConfigs.colors.wasteCircles).attr("class","dumpingLocation"),journeyConfigs.mapEl.dumpingWharves.animationPlayed=!1,journeyConfigs.mapEl.dumpingWharves.startAnimation=function(){journeyConfigs.mapEl.dumpingWharves.animationPlayed||(journeyConfigs.mapEl.dumpingWharves.animationPlayed=!0,m.selectAll(".legend-dumping").remove(),v.selectAll(".dumpingLocation").each(function(t,e){d3.select(this).attr("r",0)}),k.selectAll(".dumpingLines").each(function(t,e){d3.select(this).attr("stroke-dasharray",function(t){return this.getTotalLength()+" "+this.getTotalLength()}).attr("stroke-dashoffset",function(t){return this.getTotalLength()}).attr("class","dumpingLines").transition().duration(1500).attr("stroke-dashoffset",0).each("end",function(){journeyConfigs.mapEl.dumpingWharves.transitionCircles()})}))},journeyConfigs.mapEl.dumpingWharves.transitionCircles=function(){v.selectAll(".dumpingLocation").each(function(t,e){d3.select(this).attr("r",0).transition().duration(1500).attr("r",45).each("end",function(){journeyConfigs.mapEl.dumpingWharves.linesOut()})})},journeyConfigs.mapEl.dumpingWharves.linesOut=function(){m.selectAll("text").data(n.features).enter().append("text").attr("x",function(t){return d([t.geometry.coordinates[0],t.geometry.coordinates[1]])[0]}).attr("y",function(t){return d([t.geometry.coordinates[0],t.geometry.coordinates[1]])[1]}).attr("transform",function(t){return"translate(50,0)"}).attr("class","legend-dumping map-legend").text("Ocean dumping"),m.selectAll("text-below").data(n.features).enter().append("text").attr("x",function(t){return d([t.geometry.coordinates[0],t.geometry.coordinates[1]])[0]}).attr("y",function(t){return d([t.geometry.coordinates[0],t.geometry.coordinates[1]])[1]}).attr("transform",function(t){return"translate(50,17)"}).attr("class","legend-dumping map-legend").text("off Sandy Hook"),k.selectAll(".dumpingLines").each(function(t,e){d3.select(this).attr("stroke-dasharray",function(t){return this.getTotalLength()+" "+this.getTotalLength()}).attr("stroke-dashoffset",0).attr("class","dumpingLines").transition().duration(1500).attr("stroke-dashoffset",function(t){return-this.getTotalLength()})}),setTimeout(function(){journeyConfigs.mapEl.dumpingWharves.animationPlayed=!1},1600)}}function y(t,a,r,s){var i=".map-"+journeyConfigs.mapEl.landfillsNyc.slug,o="#map-"+journeyConfigs.mapEl.landfillsNyc.slug+"-svg",p=.99*$(i).width(),c=e,d=d3.geo.mercator().scale(1).translate([0,0]),g=d3.geo.path().projection(d),f=g.bounds(t),u=.75,y=u/Math.max((f[1][0]-f[0][0])/p,(f[1][1]-f[0][1])/c),h=[(p-y*(f[1][0]+f[0][0]))/2,(c-y*(f[1][1]+f[0][1]))/2];d.scale(y).translate(h),d3.select(o)&&d3.select(o).remove();var m=d3.select(i).append("svg").attr("width",p).attr("height",c).attr("id",o.substring(1,o.length)).on("click",function(t){journeyConfigs.mapEl.landfillsNyc.startAnimation()});$(o).css({position:"absolute",top:-l});var j=(m.append("circle").attr("cx",p/2).attr("cy",c/2).attr("r",p/2).attr("fill",journeyConfigs.mapConfigs.colors.background).attr("stroke-width",0),m.append("clipPath").attr("id","mapClip").append("circle").attr("cx",p/2).attr("cy",c/2).attr("r",p/2),m.append("g").attr("class","mapGroup").attr("clip-path","url(#mapClip)")),C=j.append("g").attr("class","usStates"),w=j.append("g").attr("class","nycd"),k=j.append("g").attr("class","landfillsNycAreas"),_=j.append("g").attr("class","landfillsNycPlaces");w.selectAll(".nycd").data(s.features).enter().append("path").attr({d:g}).style("stroke",journeyConfigs.mapConfigs.colors.land).style("stroke-width",0).style("fill",journeyConfigs.mapConfigs.colors.land),C.selectAll(".usStates").data(r.features).enter().append("path").attr({d:g}).style("stroke","#fff").style("stroke-width",0).style("fill",journeyConfigs.mapConfigs.colors.land),k.selectAll(".landfillsNycAreas").data(t.features).enter().append("path").attr({d:g}).style("stroke","#fff").style("stroke-width",.5).style("fill",function(t){return t.properties.year<=1900?journeyConfigs.mapConfigs.colors.scale[0]:t.properties.year<=1924&&t.properties.year>1900?journeyConfigs.mapConfigs.colors.scale[1]:t.properties.year<=1957&&t.properties.year>1925?journeyConfigs.mapConfigs.colors.scale[2]:t.properties.year>1957?journeyConfigs.mapConfigs.colors.scale[3]:void 0}).attr("opacity",0).attr("class","landfillsNycAreas");var v=["Areas landfilled:"],A=["1844-1900","1907-1924","1925-1957","1958-today"],x=20,E=20,P=10,S=n?10:60,L=n?100:c/2,N=(m.selectAll("landfillsLegendTitle").data(v).enter().append("text").attr("class","map-legend legend-landfills").attr("id","landfills-legend-title").attr("x",S).attr("y",L-P).text(function(t,e){return v[e]}).attr("opacity",0),m.selectAll("landfillsLegend").data(journeyConfigs.mapConfigs.colors.scale).enter().append("g").attr("class","map-legend legend-landfills").attr("id",function(t,e){return"landfills-legend-"+e}).attr("opacity",0));N.append("rect").attr("class","legend-landfills").attr("x",S).attr("y",function(t,e){return L+e*E+e*P}).attr("width",x).attr("height",E).style("fill",function(t,e){return t}),N.append("text").attr("class","legend-landfills").attr("x",S+x+P).attr("y",function(t,e){return L+e*E+13+e*P}).text(function(t,e){return A[e]}),_.selectAll(".landfillsNycPlaces").data(a.features).enter().append("circle").attr("cx",function(t){return d([t.geometry.coordinates[0],t.geometry.coordinates[1]])[0]}).attr("cy",function(t){return d([t.geometry.coordinates[0],t.geometry.coordinates[1]])[1]}).attr("r",0).style("stroke","#fff").style("stroke-width",1).style("fill",journeyConfigs.mapConfigs.colors.wasteCircles).attr("class","landfillsNycPlaces"),journeyConfigs.mapEl.landfillsNyc.animationPlayed=!1,journeyConfigs.mapEl.landfillsNyc.startAnimation=function(){journeyConfigs.mapEl.landfillsNyc.animationPlayed||(journeyConfigs.mapEl.landfillsNyc.animationPlayed=!0,_.selectAll(".landfillsNycPlaces").each(function(t,e){d3.select(this).attr("r",0)}),k.selectAll(".landfillsNycAreas").each(function(t,e){d3.select(this).attr("opacity",0).transition().duration(1500).attr("opacity",function(t){return t.properties.year<=1900?1:0}).each("end",function(t,e){d3.select("#landfills-legend-title").attr("opacity",1),d3.select("#landfills-legend-0").attr("opacity",1)}).transition().duration(1500).attr("opacity",function(t){return t.properties.year<=1924?1:0}).each("end",function(t,e){d3.select("#landfills-legend-1").attr("opacity",1)}).transition().duration(1500).attr("opacity",function(t){return t.properties.year<=1957?1:0}).each("end",function(t,e){d3.select("#landfills-legend-2").attr("opacity",1)}).transition().duration(1500).attr("opacity",function(t){return t.properties.year<2017?1:0}).each("end",function(){d3.select("#landfills-legend-3").attr("opacity",1),journeyConfigs.mapEl.landfillsNyc.animationPlayed=!1})}))},journeyConfigs.mapEl.landfillsNyc.transitionCircles=function(){_.selectAll(".landfillsNycPlaces").each(function(t,e){d3.select(this).attr("r",0).transition().duration(1500).attr("r",3).each("end",function(){journeyConfigs.mapEl.landfillsNyc.linesOut()})})},journeyConfigs.mapEl.landfillsNyc.linesOut=function(){m.selectAll("text").data(a.features).enter().append("text").attr("class","map-label").attr("x",function(t){return d([t.geometry.coordinates[0],t.geometry.coordinates[1]])[0]}).attr("y",function(t){return d([t.geometry.coordinates[0],t.geometry.coordinates[1]])[1]}).attr("transform",function(t){return"translate(5,0)"}).text(function(t){return t.properties.name})}}function h(t,a,r,s){var i=.99*$(".map-transfer-stations").width(),o=e,p=d3.geo.albers().scale(1).translate([0,0]),c=d3.geo.path().projection(p),d=c.bounds(t),g=.8,f=g/Math.max((d[1][0]-d[0][0])/i,(d[1][1]-d[0][1])/o),u=[(i-f*(d[1][0]+d[0][0]))/2,(o-f*(d[1][1]+d[0][1]))/2];p.scale(f).translate(u),d3.select("#map-transfer-stations-svg")&&d3.select("#map-transfer-stations-svg").remove();var y=d3.select(".map-transfer-stations").append("svg").attr("width",i).attr("height",o).attr("id","map-transfer-stations-svg").on("click",function(t){journeyConfigs.mapEl.transferStations.startAnimation()});$("#map-transfer-stations-svg").css({position:"absolute",top:-l});var h=(y.append("circle").attr("cx",i/2).attr("cy",o/2).attr("r",i/2).attr("fill",journeyConfigs.mapConfigs.colors.background).attr("stroke-width",0),y.append("clipPath").attr("id","mapClip").append("circle").attr("cx",i/2).attr("cy",o/2).attr("r",i/2),y.append("g").attr("class","mapGroup").attr("clip-path","url(#mapClip)")),m=h.append("g").attr("class","usStates"),j=h.append("g").attr("class","commDist"),C=h.append("g").attr("class","censusTracts"),w=h.append("g").attr("class","transferStationPoints");m.selectAll(".usStates").data(r.features).enter().append("path").attr({d:c}).style("stroke","black").style("stroke-width",0).style("fill",journeyConfigs.mapConfigs.colors.land).attr("class","usStates"),j.selectAll(".nycd").data(s.features).enter().append("path").attr({d:c}).style("stroke","black").style("stroke-width",0).style("fill",journeyConfigs.mapConfigs.colors.land).attr("class","nycd"),C.selectAll(".censusTracts").data(a.features).enter().append("path").attr({d:c}).style("stroke","#1485CC").style("stroke-width",.5).style("fill","#1485CC").attr("class","nycd"),w.selectAll(".transferStationPoints").data(t.features).enter().append("circle").attr("cx",function(t){return p([t.geometry.coordinates[0],t.geometry.coordinates[1]])[0]}).attr("cy",function(t){return p([t.geometry.coordinates[0],t.geometry.coordinates[1]])[1]}).attr("r",0).style("stroke","#fff").style("stroke-width",1).attr("opacity",1).style("fill",journeyConfigs.mapConfigs.colors.wasteCircles).attr("class","transferStationPoints");var k=[">25% below poverty","Transfer station"],_=["#1485CC","#f15a29"],v=20,A=20,x=10,E=n?10:60,P=n?100:o/2,S=y.selectAll("povScale").data(_).enter().append("g").attr("class","map-legend ts-legend").attr("id",function(t,e){return"ts-legend-"+e}).attr("opacity",1);S.append("rect").attr("class","ts-legend").attr("x",E).attr("y",function(t,e){return P+e*A+e*x}).attr("width",v).attr("height",A).style("fill",function(t,e){return t}),S.append("text").attr("class","ts-legend").attr("x",E+v+x).attr("y",function(t,e){return P+e*A+13+e*x}).text(function(t,e){return k[e]}),journeyConfigs.mapEl.transferStations.animationPlayed=!1,journeyConfigs.mapEl.transferStations.startAnimation=function(){journeyConfigs.mapEl.transferStations.animationPlayed||(journeyConfigs.mapEl.transferStations.animationPlayed=!0,w.selectAll(".transferStationPoints").each(function(t,e){d3.select(this).attr("r",0)}),w.selectAll(".transferStationPoints").each(function(t,e){d3.select(this).attr("r",0).transition().duration(1500).attr("r",function(t){return journeyConfigs.mapConfigs.scales.circleRadius(t.properties.rec_2014)}).each("end",function(){journeyConfigs.mapEl.transferStations.linesOut()})}))},journeyConfigs.mapEl.transferStations.transitionCircles=function(){},journeyConfigs.mapEl.transferStations.linesOut=function(){setTimeout(function(){journeyConfigs.mapEl.transferStations.animationPlayed=!1},1600)}}journeyConfigs.mapConfigs.colors={background:"#edf0ff",land:"#d9d9d9",wasteLines:"#f15a29",wasteCircles:"#f15a29",scale:["#FFBDA6","#FF885E","#f15a29","#992D09"]},journeyConfigs.mapConfigs.scales={circleRadius:function(t){return.025*Math.sqrt(t/3.14)},lineWidth:function(t){return journeyConfigs.mapConfigs.scales.circleRadius(t)/2}},d3.json(journeyConfigs.mapDataPath,function(t){var e=t.nycd,a=t.ny_nj_ct,n=t.dumping_lines,r=t.dumping_wharves,s=t.dumping_location,i=t.landfills_nyc_areas,l=t.landfills_nyc_points,o=t.all_transfer_stations,p=t.census_tracts_poverty;u(n,r,s,a,e),y(i,l,a,e),h(o,p,a,e)})}var visImageSizes=[{height:600,width:2454,type:"jpg",filename:"600_fk-closure.jpg"},{height:600,width:1333,type:"jpg",filename:"600_fresh-kills-dumping.jpg"},{height:600,width:1092,type:"jpg",filename:"600_incinerator.jpg"},{height:600,width:476,type:"jpg",filename:"600_initial.jpg"},{height:600,width:733,type:"jpg",filename:"600_panel-0-1.jpg"},{height:600,width:972,type:"jpg",filename:"600_panel-1-2-2.jpg"},{height:600,width:972,type:"jpg",filename:"600_panel-1-2.jpg"},{height:600,width:1009,type:"jpg",filename:"600_panel-1-4.jpg"},{height:600,width:1716,type:"jpg",filename:"600_panel-1-7.jpg"},{height:600,width:1269,type:"jpg",filename:"600_panel-1-9.jpg"},{height:600,width:706,type:"jpg",filename:"600_panel-3-2.jpg"},{height:600,width:814,type:"jpg",filename:"600_panel-3-3-2.jpg"},{height:600,width:706,type:"jpg",filename:"600_panel-3-3-2_new.jpg"},{height:600,width:814,type:"jpg",filename:"600_panel-3-3.jpg"},{height:600,width:706,type:"jpg",filename:"600_panel-3-3_new.jpg"},{height:600,width:843,type:"jpg",filename:"600_panel-3-4.jpg"},{height:600,width:1104,type:"jpg",filename:"600_panel-3-5.jpg"},{height:800,width:3272,type:"jpg",filename:"800_fk-closure.jpg"},{height:800,width:1777,type:"jpg",filename:"800_fresh-kills-dumping.jpg"},{height:800,width:1456,type:"jpg",filename:"800_incinerator.jpg"},{height:800,width:635,type:"jpg",filename:"800_initial.jpg"},{height:800,width:977,type:"jpg",filename:"800_panel-0-1.jpg"},{height:800,width:1296,type:"jpg",filename:"800_panel-1-2-2.jpg"},{height:800,width:1296,type:"jpg",filename:"800_panel-1-2.jpg"},{height:800,width:1345,type:"jpg",filename:"800_panel-1-4.jpg"},{height:800,width:2288,type:"jpg",filename:"800_panel-1-7.jpg"},{height:800,width:1692,type:"jpg",filename:"800_panel-1-9.jpg"},{height:800,width:941,type:"jpg",filename:"800_panel-3-2.jpg"},{height:513,width:696,type:"jpg",filename:"800_panel-3-3-2.jpg"},{height:700,width:824,type:"jpg",filename:"800_panel-3-3-2_new.jpg"},{height:513,width:696,type:"jpg",filename:"800_panel-3-3.jpg"},{height:700,width:824,type:"jpg",filename:"800_panel-3-3_new.jpg"},{height:800,width:1124,type:"jpg",filename:"800_panel-3-4.jpg"},{height:800,width:1472,type:"jpg",filename:"800_panel-3-5.jpg"}],journeyConfigs={};journeyConfigs.meta={name:"History of NYC's Waset",slug:"history",id:2},journeyConfigs.firstPanelId="panel-0-1",journeyConfigs.visSteps=[{step:1,name:"Collection",id:"1-1"},{step:2,name:"Transfer",id:"2-1"}],journeyConfigs.mapEl={dumpingWharves:{id:"2-2",slug:"dumping-wharves"},landfillsNyc:{id:"2-8",slug:"landfills-nyc"},transferStations:{id:"4-2",slug:"transfer-stations"}},journeyConfigs.mapDataPath="data/history.geojson",journeyConfigs.mapConfigs={};